
<div id="remove-review-dialog" class="hidden">
  Remove this review event?
</div>
<% if current_user.sign_in_count == 1 %>
  <div class="info ui-corner-all">
    <a href="#" class="button ui-corner-all ui-state-default" 
       style="float:right; margin-left:1em;">Hide</a>
    <span style="font-size:1.5em;">Getting Started is Easy</span>.<br />
    <ul style="margin-left:2em;">
      <li style="list-style:circle;">Try out this <a href="#">tutorial</a> 
        that will guide you through submitting your first changeset for 
        others to review.
      </li>
      <li style="list-style:circle;">To get the most out of using 
        <strong>Review</strong>, 
        <a href="#">download</a> the accompanying command line utility that 
        will help you submit changesets for others to review.  You can also
        submit changesets directly through this website by clicking the
        Add button next to <em>My Pending Reviews</em> below to create a new
        review request.
      </li> 
    </ul>
    <!--To get started, you can download the Review 
    utility by clicking the download button for your OS below.  The Review 
    utility will help in submitting change sets for others to review.  
    Changes can also be submitted manually via this website.<br />
    For more information on how to use the utility, visit the 
    <a href="#">utility</a> page.
    <div style="text-align:center; padding:1em;">
      <a href="#" style="margin:0.8em;"><img src="/images/windows-logo.png" /></a>
      <a href="#" style="margin:0.8em;"><img src="/images/linux-logo.png" /></a>
      <a href="#" style="margin:0.8em;"><img src="/images/apple-logo.png" /></a>
    </div>-->
  </div>
<% end %>

<div class="ui-widget ui-corner-top box">
  <h1>My Review Requests</h1>

  <% if current_user.sign_in_count == 1 and 
        current_user.current_requests.size == 0 %>
    <div style="font-size:0.9em;">
      <span class="ui-icon ui-icon-info" style="float:left; margin-right:0.3em;"></span>
      <strong>You don't have any review requests yet</strong>... 
      <br />
      This is where you will see review requests from other users when 
      they ask you to take a look at their code. 
    </div>
  <% else %>
    <ul>
      <% requests = 0 %>
      <% current_user.current_requests.each do |r| %>
        <% extra = "neardue" if not r.duedate.nil? and (r.duedate.to_date - 2).past? %>
        <% extra = "overdue" if not r.duedate.nil? and r.duedate.to_date.past? %>
        <li class="ui-corner-all review-event" style="margin-bottom:0.5em;">
          <span class="ui-icon ui-icon-carat-1-e inline-icon" 
                style="margin-right:0.3em"></span>
          <%= link_to "#{r.name}", review_event_path(r.id) %>
          <span class="author">by <%= r.owner.username %></span>
          <% if not r.duedate.nil? %>
            <% countdown = r.duedate.to_date - DateTime.now.to_date %>
            <span class="ui-corner-all <%= extra %>" 
                  style="padding:0.2em 0.5em;">
              due <%= "in" if countdown > 0 %> 
              <%= countdown == 0 ? "today" : countdown.abs.days.inspect %>
              <%= "ago" if countdown < 0 %>
            </span>
          <% end %>
        </li>
      <% end %>
      <% if current_user.review_requests.size == 0 %>
        <li><em>No one has requested you review their code yet.</em></li>
      <% elsif current_user.current_requests.size == 0 %>
        <li><em>No review requests at this time.</em></li>
      <% end %>

  <!--    <li class="ui-corner-all"><span class="ui-icon ui-icon-carat-1-e" style="float:left; margin-right:0.3em"></span>
      <a href="#">Minor change</a> <span class="author">by Joe Bob</span></li>
      <li class="ui-corner-all overdue"><span class="ui-icon ui-icon-carat-1-e" style="float:left; margin-right:0.3em"></span>
      <a href="#">Major change to everything</a> <span class="author">by Sally Mae</span></li> -->
    </ul>
  <% end %>
</div>

<div class="ui-widget ui-corner-top box">
  <h1>My Pending Reviews
    <!--<a href="#" class="ui-corner-all ui-state-default button"><span class="ui-icon ui-icon-circle-plus left"></span>Add</a>-->
    <%= link_to new_review_event_path, :class => "ui-corner-all ui-state-default button" do %>
      <span class="ui-icon ui-icon-circle-plus left"></span>Add
    <% end %>
  </h1>

  <% if current_user.sign_in_count == 1 and 
        current_user.reviews_owned.size == 0 %>
    <div style="font-size:0.9em;">
      <span class="ui-icon ui-icon-info left" style="margin-right:0.3em;"></span>
      <strong>You haven't made any review requests yet</strong>... 
      <br />
      This is where you will see review requests to other users while 
      you are waiting for them to take a look at your code. 
    </div>
  <% else %>
    <ul>
      <% current_user.reviews_owned.each do |r| %>
        <li class="ui-corner-all review-event">
          <div style="display:inline-block; vertical-align:middle;">
            <span class="ui-icon ui-icon-carat-1-e inline-icon" 
                  style="margin-right:0.3em"></span>
            <%= link_to "#{r.name}", review_event_path(r.id) %>
            <span class="author">by <%= current_user.username %></span>
            <% if not r.changesets.last.nil? %>
              <% if r.changesets.last.rejected? %>
                <span class="ui-corner-all rejected" 
                      style="padding:0.2em 0.5em;margin:0;">Rejected</span>
              <% elsif r.changesets.last.accepted? %>
                <span class="ui-corner-all accepted" 
                      style="padding:0.2em 0.5em;margin:0;">Accepted</span>
              <% end %>
            <% end %>
          </div>
          <div class="review-event-actions">
            <%= link_to_js "remove_review_event(this, '#{r.id}');" do %>
              <span class="ui-icon ui-icon-close left"></span>
              Delete
            <% end %>
          </div>
        </li>
      <% end %>
      <% if current_user.reviews_owned.size == 0 %>
        <li><em>You haven't submitted any code for review yet!
            <a href="#">Download</a> the utility to submit new changesets or
            click the Add button above.</a>
           </em></li>
      <% end %>
      <!--<li class="ui-corner-all neardue"><span class="ui-icon ui-icon-carat-1-e" style="float:left; margin-right:0.3em"></span>
      <a href="#">Super awesome stuff</a> <span class="author">by Andrew Thigpen</span></li>
      <li></li>-->
    </ul>
  <% end %>
</div>

<div class="ui-widget ui-corner-top box">
  <h1>Recent Activity</h1>
  <ul>
    <li><em>No recent activity.</em></li>
    <!--<li class="ui-corner-all neardue"><span class="ui-icon ui-icon-carat-1-e" style="float:left; margin-right:0.3em"></span>
    <a href="#">Super awesome stuff</a> <span class="author">by Andrew Thigpen</span></li>
    <li></li>-->
  </ul>
</div>

<!--<div class="ui-widget ui-corner-top box">
  <h1>Recent Reviews</h1>
  <ul>
    <li><em>No recent reviews.</em></li>
  </ul>
</div>

<div class="ui-widget ui-corner-top box">
  <h1>Recent Requests</h1>
  <ul>
    <li><em>No recent requests.</em></li>
  </ul>
</div>-->

